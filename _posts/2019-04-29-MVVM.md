---
title: MVVM Cookbook
layout: post
---
<script src="//code.jquery.com/jquery.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.7.1/gist-embed.min.js"></script>


Credit: [fcamuso](https://www.youtube.com/playlist?list=PL0qAPtx8YtJe3WjjoRaB28ZGlX9heBqn3)

## [WPF & MVVM in C# ITA - 03: Hello World](https://youtu.be/QeC1jODur7o)

- Nest two stack panels for better layout control
- x: Refers to the xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" namespace
- mc:Ignorable="d" Specifies which XML namespace prefixes encountered in a markup file may be ignored by a XAML processor.
- Click property will add a button Click event in xaml.cs
- x:FiledModifier = "private" makes the fields private

<code data-gist-id="311d62164b6edac8b146affdb0940a30" data-gist-file="1-MainWindow.xaml" data-gist-hide-footer="true" data-gist-line="15-25"></code>

<code data-gist-id="311d62164b6edac8b146affdb0940a30" data-gist-file="1-MainWindow.xaml.cs" data-gist-hide-footer="true" data-gist-line="1-18"></code>

## [WPF & MVVM in C# ITA - 4: Data Service](https://youtu.be/q0InN1l6RzU)

- Remove Name text box and change Surname text box to combobox 
- Add a class (*Person*) and a (static) data source *PeopleService* defining a list of *Person*
- Combobox is linked to an abstract class (model) not to the data source directly -> easier to substitute the data source
- Create an instance of *PeopleService* and assign it to the comboBox.ItemSource
- Specify the property to be displayed using combobox.DisplayMemberPath
- In the Click event, cast the comboBox.SelectedItem to a *Person* object in order to access its properties (Name and Surname)

<code data-gist-id="311d62164b6edac8b146affdb0940a30" data-gist-file="2-MainWindow.xaml" data-gist-hide-footer="true"></code>

<code data-gist-id="311d62164b6edac8b146affdb0940a30" data-gist-file="2-MainWindow.xaml.cs" data-gist-hide-footer="true"></code>

<code data-gist-id="311d62164b6edac8b146affdb0940a30" data-gist-file="2-Person.cs" data-gist-hide-footer="true"></code>

<code data-gist-id="311d62164b6edac8b146affdb0940a30" data-gist-file="2-PeopleService.cs" data-gist-hide-footer="true"></code>

- To make our code independent from a class named *PeopleService* -> Make MainWindow independent from the Service used
- Add an interface to the PeopleService class

```csharp
    public interface IPeopleService
    {
        IList<Person> People { get; } //declare a read only property. 
        //Will be made available in the class implementing the interface
    }
```

- In the MainWindow change the field from *PeopleService* to *IPeopleService*
- Add a *IPeeopleService* parameter to the MainWindow constructor -> the Service will then be created outside the MainWindow class
 
 ```csharp
        private Models.IPeopleService peopleService = null; 

        public MainWindow(Models.IPeopleService _peopleService)
        {
            InitializeComponent();       
            peopleService = _peopleService;
            comboSurname.ItemsSource = peopleService.People;
            comboSurname.DisplayMemberPath = "Surname";
        }
 ```
 
 - MainWindow does not know the nature of the class we are passing, it only needs to respect the IPeopleService interface (does not have to look like something, but it has to behave like something)
 - The PeopleService class must be created in the App class
 
 ```csharp
        private void Application_Startup(object sender, StartupEventArgs e)
        {
            MainWindow mainWindow = new MainWindow(new Models.PeopleService());
            mainWindow.Show();
        }
```

- in the App.xaml, replace the StartupURI with

```csharp
Startup="Application_Startup">
```

- You can also remove the Startup property and change the code as:

```csharp
        protected override void OnStartup(StartupEventArgs e)
        {
            base.OnStartup(e);
            MainWindow mainWindow = new MainWindow(new Models.PeopleService());
            MainWindow.Show();
        }
```

## [WPF & MVVM in C# ITA - 5: Binding & ViewModel](https://youtu.be/dRdUXq8Q_t4)