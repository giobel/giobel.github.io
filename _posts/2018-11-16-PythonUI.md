---
title: Python UI using Macro Manager
layout: post
---
<script src="//code.jquery.com/jquery.js"></script>

<script src="//d3js.org/d3.v3.min.js"></script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/gist-embed/2.7.1/gist-embed.min.js"></script>

SharpDevelop inside Revit has a really good tool to create windows form. The components can be dragged onto the canvas and then the code can be copied into a Python node in Dynamo with some minor tweaks. 

<img src="/images/Dialog.PNG" width="1000" style="display:block; margin-left: auto; margin-right: auto;">

Let's start loading all the required namespaces Windows.Forms (import all the components required: Button, Label, TextBox...), Drawing and EventHandler:
```python
clr.AddReference("System.Windows.Forms")
from System.Windows.Forms import Application, Button, Form, Label, TextBox, CheckBox, FolderBrowserDialog, OpenFileDialog, DialogResult, ComboBox, FormBorderStyle, FormStartPosition

clr.AddReference("System.Drawing")
from System.Drawing import *

clr.AddReference("System")
from System import EventHandler
```


From Form1.Designer.cs copy the code inside the InitializeComponent method:

<code data-gist-id="a90eb49a0c322bb2f0c3adfbd1acc794" data-gist-file="winForm.cs" data-gist-hide-footer="true" data-line="3-16"></code>

Remove all the C# keywords (`this.`, `new`) and all the namespaces that we define before (`System.Windows.Forms`)
`SuspendLayout();` throws an error, so let's remove that too.  

<code data-gist-id="b5ffcb2e04e31d68ad7687ed4fa48f8c" data-gist-file="PythonUI.py" data-gist-hide-footer="true" data-line="41-54"></code>

Do the same for all the components definitions removing `new System.Drawing.` and `new System.`

<code data-gist-id="a90eb49a0c322bb2f0c3adfbd1acc794" data-gist-file="winForm.cs" data-gist-hide-footer="true" data-line="17-141"></code>

<code data-gist-id="b5ffcb2e04e31d68ad7687ed4fa48f8c" data-gist-file="PythonUI.py" data-gist-hide-footer="true" data-line="55-177"></code>